<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="reference"/>
<meta name="DC.Title" content="ScanReadFormatWrite.spl"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="spldoc_compilationunit__"/>
<link rel="stylesheet" type="text/css" href="../html/commonltr.css"/>
<link rel="stylesheet" type="text/css" href="../html/spldoc.css"/>
<title>ScanReadFormatWrite.spl</title>
</head>
<body id="spldoc_compilationunit__">


<h1 class="title topictitle1">ScanReadFormatWrite.spl</h1>

<div class="body refbody">
<div class="section">
<p class="p">
<a class="xref" href="toolkit.html">
ScanReadFormatWrite
</a>
-&gt; <a class="xref" href="sample$.html">sample</a>-&gt; ScanReadFormatWrite.spl</p>

</div>

<div class="section"><h2 class="title sectiontitle splhead-1">Content</h2>
  
    <dl class="dl">
    <dt class="dt dlterm"/>
<dd class="dd"/>

    
      <dt class="dt dlterm splhead-2">Composites</dt>

      <dd class="dd"><dl class="dl">
  
     <dt class="dt dlterm"><a class="xref" href="#spldoc_compilationunit____composite_operator__ScanReadFormatWrite">composite ScanReadFormatWrite</a></dt>

     <dd class="dd">Demonstrates the use of the HFDSHelpers, showing how options like closeOnPunct can be supported.</dd>

  
  
     <dt class="dt dlterm"><a class="xref" href="#spldoc_compilationunit____composite_operator__HDFSFileSinkCloseOnPunct">composite HDFSFileSinkCloseOnPunct(input inStream)</a></dt>

     <dd class="dd">HDFS2FileSink with closeOnPunct set to true.</dd>

  
     </dl>
</dd>

    
     </dl>

</div>

<div class="section"><h2 class="title sectiontitle splhead-1">Composites</h2>
  
</div>

<div class="section" id="spldoc_compilationunit____composite_operator__ScanReadFormatWrite"><h2 class="title sectiontitle splpart">composite ScanReadFormatWrite</h2>
  
</div>

<div class="section">

<p class="p">Demonstrates the use of the HFDSHelpers, showing how options like closeOnPunct can be supported. To use this composite, place <tt class="ph tt">data/testread1.txt</tt> and <tt class="ph tt">data/testread2.txt</tt> in the scanDir (defaults to hdfsHelpersTest_scan/in). 
</p>

<p class="p">The HDFSDirectoryScan reads the directory, and passes the filenames off to  HDFSReadFormatInputStream.  The results of that read are written locally (testRead.csv), and also passed to two instantiations of HDFSWriteFormat.  The first instantiation works the same as in the ReadFormatWrite example. 
</p>

<p class="p">In the second, we want to have the HDFS2FileSink close the file on punctation, so we use the HDFSFormatWrite composite with writer parameter.  The operator we pass in as the writer is a  a wrapper around HDFS2FileSink with the closeOnPunct set to true.   
</p>

<div class="p">When run, three output files appear in the hdfs output directory: <tt class="ph tt">basic.txt</tt>, which contains the tuples from both files.  This is written by the first 
<pre class="pre codeblock">
      HDFSWriteFormat invocation.
</pre>


</div>

<div class="p">The second HDFSWriteFormat invocation writes two files: <tt class="ph tt">punct0.txt</tt>, which contains tuples from only the first file (since a punctuation is sent between 
<pre class="pre codeblock">
       the first and second file, and a punctuation close the file and starts a new one)
</pre>


</div>

<p class="p"><tt class="ph tt">punct1.txt</tt>, which contains tuples from only the second file 
</p>

<p class="p">Locally, in the data directory testRead.cvs is produced.  
</p>

</div>

<div class="section"><h2 class="title sectiontitle">Parameters</h2>

<ul class="sl simple">
<li class="sli"><strong class="ph b">path</strong>: 
</li>

<li class="sli"><strong class="ph b">scanDir</strong>: 
</li>

<li class="sli"><strong class="ph b">outDir</strong>: 
</li>

</ul>

</div>

<div class="section">
</div>

<div class="section">
</div>

<div class="section" id="spldoc_compilationunit____composite_operator__HDFSFileSinkCloseOnPunct"><h2 class="title sectiontitle splpart">composite HDFSFileSinkCloseOnPunct(input inStream)</h2>
  
</div>

<div class="section">

<p class="p">HDFS2FileSink with closeOnPunct set to true. This wraps HDFS2FileSink, setting closeOnPunct to true.  This allows us to pass it the HDFSWriteFormat and get close-on-punct semantics.   
</p>

</div>

<div class="section"><h2 class="title sectiontitle">Parameters</h2>

<ul class="sl simple">
<li class="sli"><strong class="ph b">file</strong>: 
</li>

<li class="sli"><strong class="ph b">hdfsUser</strong>: 
</li>

<li class="sli"><strong class="ph b">timeFormat</strong>: 
</li>

</ul>

</div>

<div class="section"><h2 class="title sectiontitle">Input Ports</h2>

<ul class="sl simple">
<li class="sli"><strong class="ph b">inStream</strong>: 
</li>

</ul>

</div>

<div class="section">
</div>

</div>


</body>
</html>